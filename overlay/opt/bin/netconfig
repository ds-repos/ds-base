#!/bin/sh

# Check if the script is run as root
if [ "$(id -u)" -ne 0 ]; then
    echo "This script must be run as root."
    exit 1
fi

if [ -d "/tmp/bsdinstall_etc" ] ; then
  rm -rf /tmp/bsdinstall_etc
fi

export BSDINSTALL_CONFIGCURRENT=yes
bsdinstall netconfig

if [ -f "/tmp/bsdinstall_etc/rc.conf.net" ] ; then
  cat /tmp/bsdinstall_etc/rc.conf.net | xargs sysrc
fi

if [ -f "/tmp/bsdinstall_etc/resolv.conf" ] ; then
  install -o root -g wheel -m 0644 /tmp/bsdinstall_etc/resolv.conf /etc/resolv.conf
fi

if [ -f "/tmp/bsdinstall_etc/wpa_supplicant.conf" ] ; then
  install -o root -g wheel -m 0644 /tmp/bsdinstall_etc/wpa_supplicant.conf /etc/wpa_supplicant
fi
